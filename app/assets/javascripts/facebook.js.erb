// have to rescue nil on FACEBOOK_CONFIG so that heroku can precompile assets
jQuery(function() {
  // load fb sdk async
  $("body").prepend('<div id="fb-root"></div>');
  return $.ajax({
    url: "" + window.location.protocol + "//connect.facebook.net/en_US/all.js",
    dataType: 'script',
    cache: true
  });
});

window.fbAsyncInit = function() {
  FB.init({
    appId: '<%= (FACEBOOK_CONFIG["app_id"] rescue nil) %>',
    channelUrl: '//' + window.location.host + '/channel.html',
    status: true,
    cookie: true,
    xfbml: true
  });

  var session = new Mamajamas.Models.LoginSession({
    scope: '<%= (FACEBOOK_CONFIG["scope"] rescue nil) %>'
  });

  var appAuth = new Mamajamas.Views.AppAuth({
    model: session,
    el: 'body'
  });
};
